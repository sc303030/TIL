# 스키마 정제와 정규화

### 데이터의 논리적 표현

- 관계 스킴의 설계
    - 관계 모델을 이용하여 어떻게 실세계를 정확히 표현할 것인가
    - 애트리뷰트, 엔티티, 관계성을 파악
    - 관연된 애트리뷰트들을 릴레이션으로 묶음
        - 효율적인 데이터 조작
        - 데이터의 중복성 감소
    - 변칙적 성질인 이상 예방

### 이상의 원인

- 애트리뷰트들 간에 존재하는 여러 종속관계를 하나의 릴레이션에 표현
- 해결방안
    - 애트리뷰트들 간의 종속관계를 분석하여 여러 개의 릴레이션으로 분해
        - → 정규화

### 함수 종속

- 정의
    - 어떤 릴레이션 R에서, 애트리뷰트 X의 값 각가에 대해 애트리뷰트 Y의 값이 하나만 연관
    - 애트리뷰트 Y는 애트리뷰트 X에 함수 종속 : X → Y
        - ex ) 학번 → 이름
    - 애트리튜브 X는 Y를 함수적으로 결정
        - X는 Y의 결정자
        - Y는 X의 종속자
    - X, Y는 복합 애트리뷰트 일 수 있음
        - ex ) (학번, 과목) → 성적
    - 릴레이션 R에서 애트리뷰트 X가 후보키리면, R의 모든 애트리뷰트 Y에 대해 X → Y 성립
    - 함수 종속 X→Y의 경우
        - 애트리뷰트 x가 반드시 키라는 것을 요건으로 하지 않음

### 함수 종속 다이어그램

- 수강 릴레이션 기본키는?(학번, 학년, 과목번호, 성적)
    - (학번, 과목번호)
- 함수 종속은>
    - (학번 ,과목번호) → 성적

### 기본 정규형

- 정규형
    - 어떤 일련의 제약 조건을 만족하는 릴레이션
- 정규화 과정
    1. 애트리뷰트들과 이들의 제약조건 들을 수집
    2. 수집된 결과를 명시된 제약 조건에 따라 어려 개의 릴레이션으로 분할 → 스키마 변환
1. 정규화의 원칙
    1. 무손실 표현
        1. 같은 의미의 정보를 유지하면서 그러나 더 바람직한 구조로 하는 것
    2. 데이터의 중복성 감소
    3. 분리의 원칙
        1. 독립적인 관계는 별개의 릴레이션으로 표현
        2. 릴레이션 각각에 대해 독립적 조작이 가능

### 제1 정규형(1NF)

- 모든 도메인이 원자 값만으로 된 릴레이션
- 복합 애트리뷰트 X에 대하여 X→Y가 성립할 때
    - 완전 함수 종속
        - X’ 가 X의 원소고 X’ →Y를 만족하는 애트리뷰트 X’가 존재하지 않음
            - ex ) (A,B) → C일 때, A → C or B → C가 성립하지 않아야 함
    - 부분 함수 종속
        - X’가 X의 원소고 X’ → Y를 만족하는 애트리뷰트 X’가 존재함
- 1NF 이상의 원인
    - 기본 키에 부분 함수 종속된 애트리뷰트가 존재
- 1NF 이상의 해결
    - 릴레이션을 분해(부분 함수 종속 제거)
    - → 2NF

### 제2 정규형(2NF)

- 1NF이면서 키에 속하지 않는 모든 애트리뷰트들이 기본 키에 완전 함수 종속
- 무손실 분해
- 이상의 원인
    - 이행적 함수 종속이 존재
        - A→B이고 B→ C ⇒ A → C
            - 애트리뷰트 C는 애트리뷰트 A에 이행적 함수 종속
- 이상의 해결
    - 릴레이션 분해(이행적 함수 종속을 제거)
        - 3NF

### 제3 정규형(3NF)

- 2NF이면서 후보 키에 속하지 않는 모든 애트리뷰트들이 후보 키에 이행적 함수 종속 되지 않음

### 보이스/코드 정규형(BCNF)

- 릴레이션 R의 모든 결정자가 후보 키이면 릴레이션 R은 BCNF에 속함
- 릴레이션 R이 BCNF에 속하면 R은 제1, 제2, 제3 정규형에 속함
- 강한 제3정규형

### 제4 정규형(4NF)

- BCNF이면서 릴레이션에서 다치 종속 되지 않음
- 다치 종속
    - A →→B
        - A의  속성값은 B의 속성값의 집합을 결정하게 됨

### 제5 정규형(5NF)

- 4NF이면서 릴레이션에 존재하는 조인 종속이 후보 키를 통해서만 성립이 되도록 하는 정규형
- 조인 종속
    - 원래의 릴레이션을 분해한 뒤 자연 조인한 결과가 원래의 릴레이션과 같은 결과가 나오는 종속성

### 정규화 과정

- 비정규 릴레이션
1. 원자 값이 아닌 도메인을 분해 → 1NF
2. 부분 함수 종속 제거 → 2NF
3. 이행 함수 종속 제거 → 3NF
4. 결정자가 후보 키가 아닌 함수종속 제거 → BCNF
5. 다치 종속 제거 → 4NF
6. 후보 키를 통하지 않은 조인 종속 제거 → 5NF

### 정규화 단점

- 릴레이션의 수가 많아져 조건 결합, 즉 join의 부담으로 인해 답은 더 늦게 나올 수 있음
    - 역정규화(비정규화 또는 반정규화)
        - 정규화된 릴레이션을 물리적 데이터 모델링 과정에서 성능을 향상시키기 위해 중복을 허용하고라도 다시 통합하거나 분할하여 구조를 재조정하는것